/*!
 * ----------------------------------------------------------
 *  MARKDOWN TEXT EDITOR PLUGIN 1.5.0
 * ----------------------------------------------------------
 * Author: Taufik Nurrohman <http://latitudu.com>
 * Licensed under the MIT license.
 *
 * REQUIRES:
 * ==========================================================
 * [1]. https://github.com/tovic/simple-text-editor-library
 * [2]. https://fortawesome.github.io/Font-Awesome/icons
 * ==========================================================
 * ----------------------------------------------------------
 *
 */

var MTE=function(e,t){function n(e){return void 0!==e}function r(e){return"string"==typeof e}function i(e){return"number"==typeof e}function l(e){return"function"==typeof e}function a(e){return"object"==typeof e}function o(e,t,n){return t="on"+t,null===n?e[t]=null:(l(e[t])&&(n=function(e,t){return function(){return e.apply(this,arguments),t.apply(this,arguments)}}(e[t],n)),void(e[t]=n))}function c(e,t){e=e||{};for(var n in t)e[n]=a(t[n])?c(e[n],t[n]):t[n];return e}function u(e,t){var n=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),r=0;return r=j.defaultView&&j.defaultView.getComputedStyle?j.defaultView.getComputedStyle(e,null).getPropertyValue(t):e.style[n]}function s(e,t){return vt(e,function(){$t(t.end+1,!0)}),!1}function f(e){return e.replace(/^\s+|\s+$/g,"")}function p(e){return e.replace(/^\s+/,"")}function d(e){return e.replace(/\s+$/,"")}function g(e){return e.replace(X.escape,"\\$1")}function h(e){return e.parentNode}var m="\u2018",v="\u2019",x="\u201C",b="\u201D",k="\u2013",$="\u2014",C="\u2026",E="\u00A6",w="\u00A9",y="\u2117",T="\u2120",L="\u2122",R="\u00AE",H="\u00B1",_="\u00D7",O="\u00F7",S="\u00B0",N="\u2039",M="\u203A",I="\u00AB",B="\u00BB",U="\u2264",z="\u2265",A="\u2260",P="\u2190",K="\u2192",D="\u2191",q="\u2193",Y="\u21B5",G="\u2318",F="\u00B7",Q="\u2116",W=this,V=window,j=document,X=new Editor(e),Z=function(){},J={tabSize:"    ",toolbar:!0,shortcut:!1,areaClass:"editor-area",toolbarClass:"editor-toolbar",toolbarIconClass:"fa fa-%s",toolbarButtonClass:"editor-toolbar-button editor-toolbar-button-%s",toolbarSeparatorClass:"editor-toolbar-separator",toolbarPosition:"before",dropClass:"custom-drop custom-drop-%s",modalClass:"custom-modal custom-modal-%s",modalHeaderClass:"custom-modal-header custom-modal-%s-header",modalContentClass:"custom-modal-content custom-modal-%s-content",modalFooterClass:"custom-modal-footer custom-modal-%s-footer",modalOverlayClass:"custom-modal-overlay custom-modal-%s-overlay",autoComplete:!0,autoIndent:!0,emptyElementSuffix:">",enableSETextHeader:!0,closeATXHeader:!1,STRONG:"**",EM:"_",UL:"- ",OL:"%d. ",HR:"---",CODE:"`",PRE:"    ",BLOCKQUOTE:"> ",actions:{ok:"OK",cancel:"Cancel",yes:"Yes",no:"No",open:"Open",close:"Close"},buttons:{bold:["Bold",G+"+B"],italic:["Italic",G+"+I"],code:["Code",G+"+K"],quote:["Quote",G+"+Q"],heading:["H1 "+k+" H6",G+"+H"],link:["Link",G+"+L"],image:["Image",G+"+G"],ol:["Ordered List",G+"++"],ul:["Unordered List",G+"+-"],rule:["Horizontal Rule",G+"+R"],undo:["Undo",G+"+Z"],redo:["Redo",G+"+Y"]},placeholders:{text:"text goes here"+C,heading_text:"Heading",link_text:"link text",list_ul_text:"List item",list_ol_text:"List item",image_alt:"Image"},prompts:{link_title:"link title goes here"+C,link_title_title:"Link Title",link_url:"http://",link_url_title:"Link URL",image_title:"image title goes here"+C,image_title_title:"Image Title",image_url:"http://",image_url_title:"Image URL"},update:Z,keydown:Z,click:Z,ready:Z,copy:Z,cut:Z,paste:Z},et=j.body,tt=j.createElement("div"),nt=j.createElement("div"),rt=j.createElement("div"),it=0,lt=null,at=null,ot=0,ct=0,ut=0,st=0,ft=et.parentNode.offsetWidth,pt=V.innerHeight>et.parentNode.offsetHeight?V.innerHeight:et.parentNode.offsetHeight,dt="\n\n",gt=" ",ht=e,mt=X.indent,vt=X.insert,xt=X.key,bt=X.outdent,kt=X.replace,$t=X.select,Ct=X.selection,Et=X.updateHistory,wt=X.wrap,yt=V.setTimeout,Tt=c(J,t),Lt=j.createElement("span");W.config=Tt,W.DOM={overlay:tt,modal:nt,drop:rt};var Rt=g(Tt.UL).replace(/\\[-+*]/g,"[-+*]"),Ht=g(Tt.OL).replace(/%d/g,"\\d+"),_t=g(Tt.tabSize),Ot=g(Tt.PRE),St=g(Tt.BLOCKQUOTE);W.shortcuts=[],W.shortcut=function(e,t){W.shortcuts[e.toLowerCase()]=t,W.shortcuts=function(){for(var e=Object.keys(W.shortcuts).sort().reverse(),t={},n=0,r=e.length;r>n;++n)t[e[n]]=W.shortcuts[e[n]];return t}()},W.event=function(e,t,n){return o(t,e,n)},W.modal=function(e,t,n){l(e)&&(n=t,t=e,e="default"),e=e||"default",n=n||{},it=et.scrollTop||et.parentNode.scrollTop,tt.className=Tt.modalOverlayClass.replace(/%s/g,e),nt.className=Tt.modalClass.replace(/%s/g,e),nt.innerHTML='<div class="'+Tt.modalHeaderClass.replace(/%s/g,e)+'"></div><div class="'+Tt.modalContentClass.replace(/%s/g,e)+'"></div><div class="'+Tt.modalFooterClass.replace(/%s/g,e)+'"></div>';var r=nt.style,i="left"in n,a="top"in n;r.visibility="hidden",yt(function(){et.appendChild(tt),et.appendChild(nt)},.1),yt(function(){var e=nt.offsetWidth,t=nt.offsetHeight;r.position="absolute",r.left=i?n.left+"px":"50%",r.top=a?n.top+"px":"50%",r.zIndex="9999",r.marginLeft=(i?0:0-e/2)+"px",r.marginTop=(a?0:it-t/2)+"px",r.visibility="",nt.offsetLeft<0&&!i&&(r.left=0,r.marginLeft=0,i=!0,n.left=0),nt.offsetTop<0&&!a&&(r.top=0,r.marginTop=0,a=!0,n.top=0);var l=nt.children[0];o(l,"mousedown",function(){return at=nt,ut=ot-at.offsetLeft,st=ct-at.offsetTop,!1}),o(et,"mousemove",null),o(et,"mousemove",function(n){ot=n.pageX,ct=n.pageY+it;var l,o,c=i?0:e/2,u=a?0:t/2;if(null!==at){var s=i?e:0,f=a?t:0;l=ot-ut+c,o=ct-st+u,c>l&&(l=c),u>o&&(o=u),l+c+s>ft&&(l=ft-c-s),o+u+f>pt&&(o=pt-u-f),r.left=l+"px",r.top=o-it+"px"}})},.2);var c=nt.children;l(t)&&t(tt,nt,c[0],c[1],c[2])},W.drop=function(e,t,n){l(e)&&(n=t,t=e,e="default"),!n&&lt&&(n={left:lt.offsetLeft,top:lt.offsetTop+lt.offsetHeight}),e=e||"default",n=n||{},it=et.scrollTop||et.parentNode.scrollTop,rt.className=Tt.dropClass.replace(/%s/g,e);var r=rt.style,i="left"in n,a="top"in n;r.visibility="hidden",yt(function(){et.appendChild(rt)},.1),yt(function(){var e=rt.offsetWidth,t=rt.offsetHeight;r.position="absolute",r.left=i?n.left+"px":"50%",r.top=a?n.top+"px":"50%",r.zIndex="9999",r.marginLeft=(i?0:0-e/2)+"px",r.marginTop=(a?0:it-t/2)+"px",r.visibility="",n.left+e>ft&&(r.left=ft-e+"px",r.marginLeft=0),n.top+t>pt&&(r.top=pt-t+"px",r.marginTop=0)},.2),l(t)&&t(rt)},W.prompt=function(e,t,n,r,i){W.modal("prompt",function(i,a,c,u,s){var f=function(e){l(r)?(W.exit(),r(e)):W.exit(!0)},p=j.createElement("input");p.type="text",p.value=t,o(p,"keydown",function(e){var r=xt(e);if("escape"==r)return W.exit(!0),!1;if("arrowdown"==r)return d.focus(),!1;if(n){if("enter"==r&&""!==this.value&&this.value!==t)return f(this.value),!1}else if("enter"==r)return f(this.value==t?"":this.value),!1});var d=j.createElement("button");d.innerHTML=Tt.actions.ok,o(d,"click",function(){return n?""!==p.value&&p.value!==t&&f(p.value):f(p.value==t?"":p.value),!1});var g=j.createElement("button");g.innerHTML=Tt.actions.cancel,o(g,"click",function(){return W.exit(!0),!1}),o(d,"keydown",function(e){var t=xt(e);return"escape"==t?(W.exit(!0),!1):"arrowup"==t?(p.focus(),!1):"arrowright"==t?(g.focus(),!1):"arrowdown"==t||"arrowleft"==t?!1:void 0}),o(g,"keydown",function(e){var t=xt(e);return"escape"==t?(W.exit(!0),!1):"arrowup"==t?(p.focus(),!1):"arrowleft"==t?(d.focus(),!1):"arrowdown"==t||"arrowright"==t?!1:void 0}),c.innerHTML=e?e:"",u.appendChild(p),s.appendChild(d),s.appendChild(j.createTextNode(" ")),s.appendChild(g),yt(function(){p.select()},.2)},i)},W.alert=function(e,t,n,r){W.modal("alert",function(r,i,a,c,u){var s=j.createElement("button");s.innerHTML=Tt.actions.ok,o(s,"click",function(){return l(n)?(W.exit(),n()):W.exit(!0),!1}),o(s,"keydown",function(e){return xt(e,"escape")?(W.exit(!0),!1):void 0}),a.innerHTML=e?e:"",c.innerHTML=t?t:"",u.appendChild(s),yt(function(){s.focus()},.2)},r)},W.confirm=function(e,t,r,i){W.modal("confirm",function(i,a,c,u,s){var f=j.createElement("button");f.innerHTML=Tt.actions.ok,o(f,"click",function(){return n(r)&&l(r.OK)?(W.exit(),r.OK()):W.exit(!0),!1});var p=j.createElement("button");p.innerHTML=Tt.actions.cancel,o(p,"click",function(){return n(r)&&l(r.CANCEL)?(W.exit(),r.CANCEL()):W.exit(!0),!1}),o(f,"keydown",function(e){var t=xt(e);return"escape"==t?(W.exit(!0),!1):"arrowright"==t?(p.focus(),!1):"arrowleft"==t||"arrowdown"==t?!1:void 0}),o(p,"keydown",function(e){var t=xt(e);return"escape"==t?(W.exit(!0),!1):"arrowleft"==t?(f.focus(),!1):"arrowright"==t||"arrowdown"==t?!1:void 0}),c.innerHTML=e?e:"",u.innerHTML=t?t:"",s.appendChild(f),s.appendChild(j.createTextNode(" ")),s.appendChild(p),yt(function(){p.focus()},.2)},i)},W.exit=W.close=function(e){if(lt=null,at=null,h(tt)&&et.removeChild(tt),h(nt)&&et.removeChild(nt),h(rt)&&et.removeChild(rt),e&&e!==!1){var t=Ct();a(e)||(e={}),$t("start"in e?e.start:t.start,"end"in e?e.end:t.end)}},o(V,"resize",function(){ft=et.parentNode.offsetWidth,pt=V.innerHeight>et.parentNode.offsetHeight?V.innerHeight:et.parentNode.offsetHeight}),o(et,"mouseup",function(){at=null}),o(tt,"click",function(){W.exit(!0)}),W.scroll=function(e,t){i(e)?ht.scrollTop=e:ht.scrollTop+=parseInt(u(ht,"line-height"),10),l(t)&&t()},W.time=function(e){var t=new Date,r=t.getFullYear(),i=t.getMonth()+1,l=t.getDate(),a=t.getHours(),o=t.getMinutes(),c=t.getSeconds(),u=t.getMilliseconds();10>i&&(i="0"+i),10>l&&(l="0"+l),10>a&&(a="0"+a),10>o&&(o="0"+o),10>c&&(c="0"+c),10>u&&(u="0"+u);var s={Y:""+r,m:""+i,d:""+l,H:""+a,i:""+o,s:""+c,u:""+u};return n(e)?s[e]:s},Tt.toolbar&&(Lt.className=Tt.toolbarClass,o(Lt,"click",function(){return W.exit(!1),!1}),ht.parentNode.insertBefore(Lt,Tt.toolbarPosition.match(/^after|bottom$/i)?null:ht));var Nt=j.createElement("a");Nt.href="#esc:"+(new Date).getTime(),Nt.style.width=0,Nt.style.height=0,ht.parentNode.appendChild(Nt),W.button=function(e,t){if("|"===e)return W.separator(t);if(t=t||{},t.title!==!1){a(t.title)||(t.title=[t.title]);var n,c=j.createElement("a");if(c.className=Tt.toolbarButtonClass.replace(/%s/g,e),c.setAttribute("tabindex",-1),c.href="#"+e.replace(" ",":").replace(/[^a-z0-9\:]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,""),c.innerHTML=t.text?t.text.replace(/%s/g,e):'<i class="'+Tt.toolbarIconClass.replace(/%s/g,e)+'"></i>',t.title[0]&&(c.title=t.title[0]),t.title[1]&&(c.title+=" ("+t.title[1]+")"),a(t.attr))for(var u in t.attr)if(r(t.attr[u])&&"+="==t.attr[u].slice(0,2)){var s=c.getAttribute(u)||"";c.setAttribute(u,s+t.attr[u].slice(2))}else c.setAttribute(u,t.attr[u]);o(c,"click",function(e){if(l(t.click)){var n=this.hash.replace("#","");return lt=c,t.click(e,W),Tt.click(e,W,n),Tt.update(e,W,n),!1}}),o(c,"keydown",function(e){return xt(e,"escape")?(W.exit(!0),!1):void 0}),i(t.position)?(n=t.position<0?t.position+Lt.children.length+1:t.position-1,Lt.insertBefore(c,Lt.children[n]||null)):Lt.appendChild(c),J.buttons[e]=t}},W.separator=function(e){e=e||{};var t,n=j.createElement("span");if(n.className=Tt.toolbarSeparatorClass,a(e.attr))for(var l in e.attr)if(r(e.attr[l])&&"+="==e.attr[l].slice(0,2)){var o=n.getAttribute(l)||"";n.setAttribute(l,o+e.attr[l].slice(2))}else n.setAttribute(l,e.attr[l]);i(e.position)?(t=e.position<0?e.position+Lt.children.length+1:e.position-1,Lt.insertBefore(n,Lt.children[t]||null)):Lt.appendChild(n)},X.tidy=function(e,t,r,i){r=n(r)?r:e;var a,o=Ct(),c=-1===e.indexOf("\n")&&o.before.match(/\n$/),u=-1===r.indexOf("\n")&&o.after.match(/^\n/),s=c?o.before:d(o.before),g=f(o.value),h=u?o.after:p(o.after),m=s.length&&!c?e:"",v=h.length&&!u?r:"";return o.value.length&&!i&&l(t)?t(o):(ht.value=s+m+g+v+h,a=(s+m).length,$t(a,a+g.length),void(l(t)&&t(Ct())))},X.toggle=function(e,t,n,r){var i=Ct();if(i.before.slice(-e.length)!=e&&i.after.slice(0,t.length)!=t)wt(e,t,!i.value.length&&r?function(){kt(/^/,r===!0?Tt.placeholders.text:r,n)}:!0);else{var l=i.before.slice(-e.length)==e?i.before.slice(0,-e.length):i.before,a=i.after.slice(0,t.length)==t?i.after.slice(t.length):i.after;ht.value=l+i.value+a,$t(l.length,(l+i.value).length,n||!0)}};var Mt=0,It=Tt.buttons,Bt=X.tidy,Ut=X.toggle,zt={bold:{title:It.bold,click:function(){var e=Tt.STRONG;Bt(gt,function(){Ut(e,e,!0,!0)})}},italic:{title:It.italic,click:function(){var e=Tt.EM;Bt(gt,function(){Ut(e,e,!0,!0)})}},"quote-right":{title:It.quote,click:function(){var e=Ct(),t=Tt.BLOCKQUOTE,n=d(e.before),r=f(e.value),i=(p(e.after),n.length?dt:"",Tt.placeholders.text);r==i?$t():(e.before.match(RegExp(St+"$"))||Bt(dt,1,dt,!0),X[r.match(RegExp("^"+St))?"outdent":"indent"](t,e.value.length?!0:function(){kt(/^/,Tt.placeholders.text)}))}},code:{title:It.code,click:function(){var e=Ct(),t="("+Ot+"|\\t| {4})",n=e.before.match(RegExp("(^|\\n)"+t+"?$")),r=Tt.CODE,i=Tt.PRE;if(n)if(-1===i.indexOf("%s"))Bt(dt,function(){X[e.value.match(RegExp("^"+t))?"outdent":"indent"](i,e.value.length?!0:function(){kt(/^/,Tt.placeholders.text)})},dt,!0);else{var l=i.split("%s");Bt(dt,function(){e=Ct(),Ut(l[0],l[1]||l[0],!0,!0)},dt,!e.before.match(RegExp(g(l[0])+"$")))}else Bt(gt,function(){Ut(r,r,!0,!0)})}},header:{title:It.heading,click:function(){var e,t=Ct(),n=["","#","##","###","####","#####","######"],r=["=","-"],i=d(t.before.replace(/#+ $/,"")),l=f(t.value.replace(/#+ | #+|\n+[-=]+/g,"").replace(/\n+/g," ")),a=p(t.after.replace(/^( #+|\n+[-=]+)/g,"")),o=i.length?dt:"",c=a.length?dt:"";if(Mt=Mt<n.length-1?Mt+1:0,t.value.length){if(Tt.enableSETextHeader&&Mt>0&&3>Mt)ht.value=i+o+l+"\n"+l.replace(/./g,r[Mt-1])+c+a,e=(i+o).length;else{var u=Mt>0?" ":"";ht.value=i+o+n[Mt]+u+l+(Tt.closeATXHeader?u+n[Mt]:"")+c+a,e=(i+o+n[Mt]+u).length}$t(e,e+l.length,!0)}else{var s=Tt.placeholders.heading_text;Mt=1,Tt.enableSETextHeader?(ht.value=i+o+s+"\n"+s.replace(/./g,r[Mt-1])+c+a,e=(i+o).length,$t(e,e+s.length,!0)):Bt(dt,function(){wt(n[Mt]+" ",Tt.closeATXHeader?" "+n[Mt]:"",function(){kt(/^/,s)})},dt,!0)}}},link:{title:It.link,click:function(e){var t,n,r=Ct(),i=Tt.placeholders.link_text;Et(),W.prompt(Tt.prompts.link_url_title,Tt.prompts.link_url,!0,function(l){n=l,W.prompt(Tt.prompts.link_title_title,Tt.prompts.link_title,!1,function(l){t=l.replace(/'/g,"&apos;").replace(/"/g,"&quot;"),Bt(gt,function(){wt("[","]("+n+(""!==t?' "'+t+'"':"")+")",r.value.length?!0:function(){kt(/^/,i)})}),Tt.update(e,W)})})}},image:{title:It.image,click:function(e){var t,n;Et(),W.prompt(Tt.prompts.image_url_title,Tt.prompts.image_url,!0,function(r){t=r,W.prompt(Tt.prompts.image_title_title,Tt.prompts.image_title,!1,function(r){n=r.replace(/"/g,"&quot;"),Bt(dt,function(){var e=Ct(),r=f(e.value.length?e.value:decodeURIComponent(t.split("/").pop().replace(/\..*$/,"").replace(/[-+._]/g," ")).toLowerCase().replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()}));r.length||(r=Tt.placeholders.image_alt),vt("!["+r+"]("+t+(""!==n?' "'+n+'"':"")+")",function(){e=Ct(),e.after.length||(ht.value+=dt),$t(e.end+2,!0)})},dt,!0),Tt.update(e,W)})})}},"list-ol":{title:It.ol,click:function(){var e=Ct(),t=Tt.placeholders.list_ol_text,n=0;if(e.value.length)e.value==t?$t():Bt(dt,function(){e.value.match(RegExp("^\\s*"+Ht))?bt(" *"+Ht,!0,!0):mt("",function(){kt(RegExp("(^|\\n) *"+Rt+" *","g"),"$1",Z),kt(/^[^\n]/gm,function(e){return n++,e.replace(/^/," "+Tt.OL.replace(/%d/g,n))})})},dt,!0);else if(e.before.match(/(^|\n)$/)){var r=" "+Tt.OL.replace(/%d/g,1);Bt(dt,function(){vt(r+t,function(){e=Ct(),$t(e.end-t.length,e.end,!0)})},dt,!0)}else{var i=RegExp("(^|\\n) *"+Ht+"(.*?)$"),l=e.before.replace(i,"$1$2");if(e.before.match(i))ht.value=l+e.after,$t(l.length,!0);else{var a=RegExp("(?:^|\\n) *("+Ht+").*?\n.*?$").exec(e.before),r=" "+Tt.OL.replace(/%d/g,a&&a[1]?parseInt(a[1],10)+1:1);e.before=e.before.replace(RegExp("(^|\\n) *"+Rt+"(.*?)$"),"$1$2").replace(/(^|\n)(.*?)$/,"$1"+r+"$2"),ht.value=e.before+e.after,$t(e.before.length,!0)}}}},"list-ul":{title:It.ul,click:function(){var e=Ct(),t=Tt.placeholders.list_ul_text,n=" "+Tt.UL;if(e.value.length)e.value==t?$t():Bt(dt,function(){kt(RegExp("(^|\\n) *"+Ht+" *","g"),"$1",Z),e.value.match(RegExp("^\\s*"+Rt))?X.outdent(" *"+Rt,!0,!0):X.indent(n)},dt,!0);else if(e.before.match(/(^|\n)$/))Bt(dt,function(){vt(n+t,function(){e=Ct(),$t(e.end-t.length,e.end,!0)})},dt,!0);else{var r=RegExp("(^|\\n) *"+Rt+"(.*?)$"),i=e.before.replace(r,"$1$2");e.before.match(r)?(ht.value=i+e.after,$t(i.length,!0)):(e.before=e.before.replace(RegExp("(^|\\n) *"+Ht+"(.*?)$"),"$1$2").replace(/(^|\n) *(.*?)$/,"$1"+n+"$2"),ht.value=e.before+e.after,$t(e.before.length,!0))}}},"ellipsis-h":{title:It.rule,click:function(){Bt(dt,function(){vt(Tt.HR,function(){var e=Ct();e.after.length||(ht.value+=dt),$t(e.end+2,!0)})},dt,!0)}},undo:{title:It.undo,click:X.undo},repeat:{title:It.redo,click:X.redo}};for(var At in zt)W.button(At,zt[At]);o(ht,"focus",W.exit),o(ht,"copy",function(e){var t=Ct();yt(function(){Tt.copy(t),Tt.update(e,W)},.1)}),o(ht,"cut",function(e){var t=Ct();yt(function(){t.end=t.start,Tt.cut(t),Tt.update(e,W),Et()},.1)}),o(ht,"paste",function(e){var t=Ct();yt(function(){t.end=Ct().end,t.value=ht.value.substring(t.start,t.end),Tt.paste(t),Tt.update(e,W),Et()},.1)}),o(ht,"keydown",function(e){var t=Ct(),n=t.before,r=t.value,i=t.after,l=t.start,a=t.end,o=xt(e),c=e.ctrlKey,u=e.shiftKey,f=e.altKey,p="tab"==o;yt(function(){Tt.keydown(e,W),Tt.update(e,W)},.1);for(var h in W.shortcuts){var G=h.replace(/\+/g,"\n").replace(/\n\n/g,"\n+").split(/\n/),V=0;for(var j in G)(G[j].match(/^ctrl|control|command|cmd|meta$/)&&c||"shift"==G[j]&&u||G[j].match(/^alt(ernate)?|option$/)&&f||"tab"==G[j]&&p||G[j]==o)&&V++;if(V===G.length)return W.shortcuts[h](e,W)}var J=n,et=i[0],tt="\\"==J.slice(-1),nt=o==et;if(Tt.autoComplete&&!tt){if(-1!==J.indexOf("(")&&")"==et&&nt||-1!==J.indexOf("{")&&"}"==et&&nt||-1!==J.indexOf("[")&&"]"==et&&nt||-1!==J.indexOf("<")&&">"==et&&nt||-1!==J.indexOf('"')&&'"'==et&&nt||-1!==J.indexOf("'")&&"'"==et&&nt||-1!==J.indexOf("`")&&"`"==et&&nt)return $t(a+1),!1;if("("==o)return s("("+r+")",t);if("{"==o)return s("{"+r+"}",t);if("["==o)return s("["+r+"]",t);if("<"==o)return s("<"+r+">",t);if('"'==o)return s('"'+r+'"',t);if(!n.match(/\w$/)){if("'"==o)return s("'"+r+"'",t);if("`"==o&&!n.match(/\w$/))return s("`"+r+"`",t)}}var rt="( *"+Ht+"| *"+Rt+"| *"+St+"|"+_t+")";if(u&&p)return bt(Tt.toolbar?rt:_t,!0,!0),!1;if(p){if(n.match(/<[^\/>]*?$/)&&">"==i[0]){var it=/<([^\/>]*?)$/.exec(n),lt=it[1].split(" ")[0];return ht.value=lt.match(/^hr|img|link|meta$/)?n+" "+Tt.emptyElementSuffix+i.substring(1):n+" ></"+lt+i,$t(l+1,!0),!1}return mt(Tt.tabSize),!1}if(c&&"z"==o)return X.undo(),!1;if(c&&"y"==o)return X.redo(),!1;if(Tt.toolbar&&Tt.shortcut&&c){if("b"==o)return zt.bold.click(),!1;if("g"==o)return zt.image.click(),!1;if("h"==o)return zt.header.click(),!1;if("i"==o)return zt.italic.click(),!1;if(!u&&"k"==o)return zt.code.click(),!1;if("l"==o)return zt.link.click(),!1;if("q"==o)return zt["quote-right"].click(),!1;if("r"==o)return zt["ellipsis-h"].click(),!1;if("+"==o)return zt["list-ol"].click(),!1;if("-"==o)return zt["list-ul"].click(),!1}if(Tt.toolbar&&" "==o){var it="(^|\\n)("+d(Ht)+"|"+d(Rt)+")";if(n.match(RegExp(it+"$")))return ht.value=n.replace(RegExp(it+"$"),"$1 $2 ")+r+i,$t(a+2,!0),!1}if("enter"==o){if(f&&!r.length)return vt(Y),!1;if(Tt.toolbar){var at="( *)("+Ht+"|"+Rt+"|(?:"+St+")+)( *)",it=RegExp("(?:^|\\n)"+at+"(.*?)$");if(n.match(it)){var ot=it.exec(n),ct=RegExp(Ht).test(ot[2])?Tt.OL.replace(/%d/g,parseInt(ot[2],10)+1):ot[2];return""===ot[4]?bt(at,!0,!0):vt("\n"+ot[1]+ct+ot[3],!0),W.scroll(),!1}}if(Tt.autoIndent){var ut=RegExp("(?:^|\\n)(("+_t+")+)(.*?)$").exec(n),st=ut?ut[1]:"";if(n.match(/[\(\{\[]$/)&&i.match(/^[\]\}\)]/)||n.match(/<[^\/]*?>$/)&&i.match(/^<\//))return vt("\n"+st+_t+"\n"+st,function(){$t(l+(st+Tt.tabSize).length+1,!0)}),W.scroll(),!1;if(n.match(RegExp(_t+"$")))return vt("\n"+st),W.scroll(),!1}}var ft={"'":v,'"':b,"---":$,"--":k,"...":C,"|":E,"(c)":w,"(C)":w,"(p)":y,"(P)":y,"(sm)":T,"(SM)":T," sm":T," SM":T,"(tm)":L,"(TM)":L," tm":L," TM":L,"(r)":R,"(R)":R,"+-":H,"-+":H,x:_,"/":O,"^":S,"<<":I,">>":B,"<":N,">":M,"<=":U,">=":z,"!=":A,"No.":Q,".":F};if(r.length){if(f){kt(/'([^']*?)'/g,m+"$1"+v,Z),kt(/"([^"]*?)"/g,x+"$1"+b,Z);for(var h in ft)kt(RegExp(g(h),"g"),ft[h],Z);return Et(),!1}}else{if(f){if(-1!==n.indexOf('"')&&'"'==i[0])return ht.value=n.replace(/"([^"]*?)$/,x+"$1")+b+i.slice(1),$t(a,!0),!1;if(-1!==n.indexOf("'")&&"'"==i[0])return ht.value=n.replace(/'([^']*?)$/,m+"$1")+v+i.slice(1),$t(a,!0),!1;if(n.slice(-2).match(/\w'$/i))return ht.value=n.slice(0,-1)+v+i,$t(a,!0),!1;if(n.slice(-2).match(/(^|\W)'$/i))return ht.value=n.slice(0,-1)+m+i,$t(a,!0),!1;if(n.match(/\((c|p|sm|tm|r)$/i)&&")"==i[0]){var pt=n.match(/\((sm|tm)$/i)?2:1;return ht.value=n.slice(0,-(pt+1))+ft["("+n.slice(-pt).toLowerCase()+")"]+i.slice(1),$t(a-pt,!0),!1}var dt=n.replace(/&lt;/g,"<").replace(/&gt;/g,">"),gt=i.replace(/&lt;/g,"<").replace(/&gt;/g,">");if(-1!==dt.indexOf("<<")&&0===gt.indexOf(">>"))return ht.value=n.replace(/(?:<<|&lt;&lt;)([^<]*)$/,I+"$1")+i.replace(/^(?:>>|&gt;&gt;)/,B),$t(dt.length-1,!0),!1;if(-1!==dt.indexOf("<")&&0===gt.indexOf(">"))return ht.value=n.replace(/(?:<|&lt;)([^<]*)$/,N+"$1")+i.replace(/^(?:>|&gt;)/,M),$t(dt.length,!0),!1;for(var h in ft)if(n.slice(-h.length)==h)return ht.value=n.slice(0,-h.length)+ft[h]+i,$t(l-h.length+1,!0),!1;if("arrowleft"==o)return vt(P),!1;if("arrowup"==o)return vt(D),!1;if("arrowright"==o)return vt(K),!1;if("arrowdown"==o)return vt(q),!1}if("delete"==o&&i.match(/^<\/[^\n>]*?>/))return ht.value=n+i.replace(/^<\/[^\n>]*?>/,""),$t(l,!0),!1;if("backspace"==o){if(Tt.toolbar){var it="( *"+Ht+"| *"+Rt+"|(?:> )+)";if(n.match(RegExp("^"+it+"$","m")))return bt(it,!0,!0),!1}if(n.match(RegExp("(^|\\n)("+_t+")+$")))return bt(Tt.tabSize),!1;if(n.match(/<\/?[^\n>]*?>$/))return bt("<\\/?[^\\n>]*?>",!0,!0),!1;switch(n.slice(-1)){case"(":return Ut("(",")"),!1;case"{":return Ut("{","}"),!1;case"[":return Ut("[","]"),!1;case"<":return Ut("<",">"),!1;case'"':return Ut('"','"'),!1;case"'":return Ut("'","'"),!1;case" ":return Ut(" "," "),!1;case x:return Ut(x,b),!1;case m:return Ut(m,v),!1;case I:return Ut(I,B),!1;case N:return Ut(N,M),!1}}}return"escape"==o?(Nt.focus(),!1):void(f||c||u||yt(Et,.1))});var Pt=RegExp("(^|\\s)"+Tt.areaClass+"(\\s|$)"),Kt=ht.className;Kt.match(Pt)||(ht.className=f(Kt+" "+Tt.areaClass)),Tt.ready(W),W.grip=X,W.grip.config=Tt};