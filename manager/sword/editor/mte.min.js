/*!
 * ----------------------------------------------------------
 *  MARKDOWN TEXT EDITOR PLUGIN 1.0.2
 * ----------------------------------------------------------
 * Author: Taufik Nurrohman <http://latitudu.com>
 * Licensed under the MIT license.
 *
 *     REQUIRES:
 *     ======================================================
 *     1. https://github.com/tovic/simple-text-editor-library
 *     2. http://fortawesome.github.io/Font-Awesome/icons
 *     ======================================================
 *
 */
;var MTE=function(f,e){var d=this,l=window,r=document,m=new Editor(f),h={tabSize:"    ",toolbar:true,toolbarClass:"editor-toolbar",toolbarPosition:"before",iconClassPrefix:"fa fa-",buttons:{OK:"OK",YES:"Yes",NO:"No",CANCEL:"Cancel"},prompt:{linkTitle:"Your link title goes here...",linkTitle_title:"Link title:",linkURL:"http://",linkURL_title:"Link URL:",imageURL:"http://",imageURL_title:"Image URL:"},placeholder:{headingText:"Your Heading Text Goes Here",linkText:"Your link text goes here...",imageAlt:"Image",listUL:"List Item",listOL:"List Item"},keydown:function(){},click:function(){},ready:function(){}};h.toolbars={bold:{title:"Bold",click:function(){m.toggle("**","**")}},italic:{title:"Italic",click:function(){m.toggle("_","_")}},code:{title:"Code",click:function(){var a=m.selection().value;if(a.indexOf("\n")!==-1&&a.length>0){m.indent(c.tabSize)}else{m.toggle("`","`")}}},"quote-right":{title:"Quote",click:function(){m.indent("> ")}},"sort-amount-desc":{title:"H1 \u2013 H6",click:function(){m.heading()}},link:{title:"Link",click:function(){var i=m.selection(),t,a,o=c.placeholder.linkText;d.prompt(c.prompt.linkTitle_title,c.prompt.linkTitle,false,function(u){t=u;d.prompt(c.prompt.linkURL_title,c.prompt.linkURL,true,function(v){a=v;m.wrap("["+(i.value.length===0?o:""),"]("+a+(t!==""?' "'+t+'"':"")+")",function(){m.select(i.start+1,(i.value.length===0?i.start+o.length+1:i.end+1),function(){m.updateHistory()})})})})}},"picture-o":{title:"Image",click:function(){d.prompt(c.prompt.imageURL_title,c.prompt.imageURL,true,function(a){var i=decodeURIComponent(a.substring(a.lastIndexOf("/")+1,a.lastIndexOf(".")).replace(/[\-\_\+]+/g," ")).toLowerCase().replace(/(?:^|\s)\S/g,function(o){return o.toUpperCase()});i=i.indexOf("/")<0?i:c.placeholder.imageAlt;m.insert("\n!["+i+"]("+a+")\n",function(){m.updateHistory()})})}},"list-ol":{title:"Ordered List",click:function(){var o=m.selection(),a=0,i="";if(o.value.length>0){m.indent("",function(){m.replace(/^[^\n\r]/gm,function(u){a++;i+=" "+a+". ";return u.replace(/^/," "+a+". ")})})}else{var t=" 1. "+c.placeholder.listOL;m.insert(t,function(){m.select(o.start+4,o.start+t.length)})}}},"list-ul":{title:"Unordered List",click:function(){var a=m.selection();if(a.value.length>0){m.indent(" * ")}else{var i=" * "+c.placeholder.listUL;m.insert(i,function(){m.select(a.start+3,a.start+i.length)})}}},"ellipsis-h":{title:"Horizontal Rule",click:function(){m.insert("\n---\n")}},"rotate-left":{title:"Undo",click:function(){m.undo()}},"rotate-right":{title:"Redo",click:function(){m.redo()}}};function n(i,a){i=i||{};for(var o in a){if(typeof a[o]==="object"){i[o]=n(i[o],a[o])}else{i[o]=a[o]}}return i}var c=n(h,e);d.modal=function(i,u){i=i||"modal";var t=document.body,a=r.createElement("div");a.className="custom-modal-overlay custom-"+i+"-overlay";var o=r.createElement("div");o.className="custom-modal custom-"+i;o.innerHTML='<div class="custom-modal-header custom-'+i+'-header"></div><div class="custom-modal-content custom-'+i+'-content"></div><div class="custom-modal-action custom-'+i+'-action"></div>';t.appendChild(a);t.appendChild(o);if(typeof u=="function"){u(a,o)}};d.prompt=function(o,i,a,t){d.modal("prompt",function(z,u){var y=function(A){z.parentNode.removeChild(z);u.parentNode.removeChild(u);if(typeof t=="function"){t(A)}};var v=r.createElement("input");v.type="text";v.value=i;v.onkeyup=function(A){if(a){if(A.keyCode==13&&this.value!==""&&this.value!==i){y(this.value)}}else{if(A.keyCode==13){y(this.value==i?"":this.value)}}};var x=r.createElement("button");x.innerHTML=c.buttons.OK;x.onclick=function(){if(a){if(v.value!==""&&v.value!==i){y(v.value)}}else{y(v.value==i?"":v.value)}};var w=r.createElement("button");w.innerHTML=c.buttons.CANCEL;w.onclick=function(){z.parentNode.removeChild(z);u.parentNode.removeChild(u)};u.children[0].innerHTML=o?o:"";u.children[1].appendChild(v);u.children[2].appendChild(x);u.children[2].appendChild(r.createTextNode(" "));u.children[2].appendChild(w);v.select()})};d.alert=function(i,a,o){d.modal("alert",function(v,t){var u=r.createElement("button");u.innerHTML=c.buttons.OK;u.onclick=function(){v.parentNode.removeChild(v);t.parentNode.removeChild(t);if(typeof o=="function"){o()}};t.children[0].innerHTML=i?i:"";t.children[1].innerHTML=a?a:"";t.children[2].appendChild(u)})};d.confirm=function(i,a,o){d.modal("confirm",function(w,t){var v=r.createElement("button");v.innerHTML=c.buttons.OK;v.onclick=function(){w.parentNode.removeChild(w);t.parentNode.removeChild(t);if(typeof o.OK=="function"){o.OK()}};var u=r.createElement("button");u.innerHTML=c.buttons.CANCEL;u.onclick=function(){w.parentNode.removeChild(w);t.parentNode.removeChild(t);if(typeof o.CANCEL=="function"){o.CANCEL()}return false};t.children[0].innerHTML=i?i:"";t.children[0].innerHTML=a?a:"";t.children[2].appendChild(v);t.children[2].appendChild(r.createTextNode(" "));t.children[2].appendChild(u)})};m.toggle=function(o,u,v){var t=m.selection();if(t.before.slice(-o.length)!=o&&t.after.slice(0,u.length)!=u){m.wrap(o,u)}else{var a=t.before.substring(0,t.before.length-o.length),i=t.after.substring(u.length);m.area.value=a+t.value+i;m.select(a.length,a.length+t.value.length,function(){m.updateHistory()})}if(typeof v=="function"){v()}};var g=0;m.heading=function(){var t=m.selection(),o=["","# ","## ","### ","#### ","##### ","###### "];g=g<o.length-1?g+1:0;if(t.value.length>0){if(!t.before.match(/\#+ $/)){m.wrap(o[g],"",function(){m.replace(/^\#+ /,"")})}else{var a=t.before.replace(/\#+ $/,""),i=t.value.replace(/^\#+ /,"");m.area.value=a+o[g]+i+t.after;m.select(a.length+o[g].length,a.length+o[g].length+i.length,function(){m.updateHistory()})}}else{var u=c.placeholder.headingText;g=1;m.insert(o[g]+u,function(){t=m.selection().end;m.select(t-u.length-o[g].length+2,t,function(){m.updateHistory()})})}};var b=r.createElement("div");b.className=c.toolbarClass;for(var k in c.toolbars){var q=r.createElement("a");q.href="#"+k;q.innerHTML='<i class="'+c.iconClassPrefix+k+'"></i>';q.onclick=function(a){c.toolbars[this.hash.replace("#","")].click();c.click(a,m);return false};if(c.toolbars[k].title){q.title=c.toolbars[k].title}if(c.toolbars[k].position){var p=c.toolbars[k].position-1;b.insertBefore(q,b.children[p])}else{b.appendChild(q)}if(c.toolbar){m.area.parentNode.insertBefore(b,c.toolbarPosition=="before"?m.area:null)}}var j=0,s=function(i,a){m.insert(i,function(){m.select(a.end+1,a.end+1)});return false};m.area.onkeydown=function(x){var u=m.selection();l.setTimeout(function(){c.keydown(x,m)},10);if(x.shiftKey&&x.keyCode==57){return s("("+u.value+")",u)}if(x.shiftKey&&x.keyCode==219){return s("{"+u.value+"}",u)}if(x.keyCode==219){return s("["+u.value+"]",u)}if(x.shiftKey&&x.keyCode==222&&u.after[0]!=='"'){return s('"'+u.value+'"',u)}if(x.keyCode==222&&u.after[0]!=="'"){return s("'"+u.value+"'",u)}if(x.shiftKey&&x.keyCode==188){return s("<"+u.value+">",u)}if(x.shiftKey&&x.keyCode==9){m.outdent("( *?[0-9]+. | *?[\\-\\+\\*] |> |"+c.tabSize+")");return false}if(x.keyCode==9){m.indent(c.tabSize);return false}if(x.ctrlKey&&x.keyCode==90){m.undo();return false}if(x.ctrlKey&&x.keyCode==89){m.redo();return false}if(x.keyCode==32){var t=/(^|\n)([0-9]+\.|[\-\+\*])$/;if(u.before.match(t)){m.area.value=u.before.replace(t,"$1 $2 ")+u.value+u.after;m.select(u.end+2,u.end+2);return false}}if(x.keyCode==13){var w=/(^|\n)( *?)([0-9]+\.|[\-\+\*]) (.*?)$/;if(u.before.match(w)){var o=w.exec(u.before),v=/[0-9]+\./.test(o[3])?parseInt(o[3],10)+1+".":o[3];m.insert("\n"+o[2]+v+" ");return false}var i=/(^|\n)( +)(.*?)$/.exec(u.before),a=i?i[2]:"";if(u.before.match(/[\[\{\(\<\>]$/)&&u.after.match(/^[\]\}\)\>\<]/)){m.insert("\n"+a+c.tabSize+"\n"+a,function(){m.select(u.start+a.length+c.tabSize.length+1,u.start+a.length+c.tabSize.length+1)});return false}m.insert("\n"+a);return false}if(x.keyCode==8){if(u.value.length===0&&u.before.match(/( *?)([0-9]+\.|[\-\+\*]) $/)){m.outdent("( *?)([0-9]+.|[-+*]) ");return false}if(u.value.length===0&&u.before.match(new RegExp(c.tabSize+"$"))){m.outdent(c.tabSize);return false}}if(j<1){j++}else{m.updateHistory();j=0}};c.ready(m);d.editor=m};