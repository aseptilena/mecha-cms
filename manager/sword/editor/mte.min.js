/*!
 * ----------------------------------------------------------
 *  MARKDOWN TEXT EDITOR PLUGIN 1.2.4
 * ----------------------------------------------------------
 * Author: Taufik Nurrohman <http://latitudu.com>
 * Licensed under the MIT license.
 *
 * REQUIRES:
 * ==========================================================
 * [1]. https://github.com/tovic/simple-text-editor-library
 * [2]. https://fortawesome.github.io/Font-Awesome/icons
 * ==========================================================
 * ----------------------------------------------------------
 *
 */

var MTE=function(e,t){function n(e){return void 0!==e}function r(e){return"string"==typeof e}function l(e){return"number"==typeof e}function i(e){return"function"==typeof e}function o(e){return"object"==typeof e}function a(e,t,n){return t="on"+t,null===n?e[t]=null:(i(e[t])&&(n=function(e,t){return function(){return e.apply(this,arguments),t.apply(this,arguments)}}(e[t],n)),void(e[t]=n))}function c(e,t){e=e||{};for(var n in t)e[n]=o(t[n])?c(e[n],t[n]):t[n];return e}function u(e,t){var n=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),r=0;return r=Y.defaultView&&Y.defaultView.getComputedStyle?Y.defaultView.getComputedStyle(e,null).getPropertyValue(t):e.style[n]}function s(e,t){return dt(e,function(){ht(t.end+1,vt)}),!1}function f(e){return e.replace(/^\s+|\s+$/g,"")}function d(e){return e.replace(/^\s+/,"")}function p(e){return e.replace(/\s+$/,"")}function g(e){return e.replace(G.escape,"\\$1")}function h(e){return e.parentNode}"prompt"in t&&(t.prompts=t.prompt),"placeholder"in t&&(t.placeholders=t.placeholder),"iconClassPrefix"in t&&(t.toolbarIconClass=t.iconClassPrefix+"%s"),"buttonClassPrefix"in t&&(t.toolbarButtonClass=t.buttonClassPrefix+"%s");var m="\u2018",v="\u2019",b="\u201C",C="\u201D",x="\u2013",k="\u2014",y="\u2026",T="\u00A6",L="\u00A9",_="\u2117",O="\u2120",E="\u2122",$="\u00AE",H="\u00B1",w="\u00D7",N="\u00F7",R="\u00B0",M="\u2039",I="\u203A",S="\u00AB",A="\u00BB",B="\u2264",P="\u2265",z="\u2260",U="\u2190",D="\u2192",K="\u2191",q="\u2193",F="\u21B5",V=this,W=window,Y=document,G=new Editor(e),j={tabSize:"    ",toolbar:!0,shortcut:!1,areaClass:"editor-area",toolbarClass:"editor-toolbar",toolbarIconClass:"fa fa-%s",toolbarButtonClass:"editor-toolbar-button editor-toolbar-button-%s",toolbarSeparatorClass:"editor-toolbar-separator",toolbarPosition:"before",dropClass:"custom-drop custom-%s-drop",modalClass:"custom-modal custom-modal-%s",modalHeaderClass:"custom-modal-header custom-modal-%s-header",modalContentClass:"custom-modal-content custom-modal-%s-content",modalFooterClass:"custom-modal-action custom-modal-%s-action",modalOverlayClass:"custom-modal-overlay custom-modal-%s-overlay",STRONG:"**",EM:"_",UL:"- ",OL:"%d. ",HR:"---",CODE:"`",PRE:"    ",buttons:{ok:"OK",yes:"Yes",no:"No",cancel:"Cancel",open:"Open",close:"Close",bold:"Bold",italic:"Italic",code:"Code",quote:"Quote",heading:"H1 "+x+" H6",link:"Link",image:"Image",ol:"Ordered List",ul:"Unordered List",rule:"Horizontal Rule",undo:"Undo",redo:"Redo"},prompts:{link_title:"link title goes here"+y,link_title_title:"Link Title",link_url:"http://",link_url_title:"Link URL",image_url:"http://",image_url_title:"Image URL"},placeholders:{text:"text goes here"+y,heading_text:"Heading",link_text:"link text",list_ul_text:"List Item",list_ol_text:"List Item",image_alt:"Image"},update:function(){},keydown:function(){},click:function(){},ready:function(){},copy:function(){},cut:function(){},paste:function(){}},Q=Y.body,X=Y.createElement("div"),J=Y.createElement("div"),Z=Y.createElement("div"),et=0,tt=null,nt=null,rt=0,lt=0,it=0,ot=0,at=Q.parentNode.offsetWidth,ct=Q.parentNode.offsetHeight,ut=function(){},st=e,ft=G.indent,dt=G.insert,pt=G.outdent,gt=G.replace,ht=G.select,mt=G.selection,vt=G.updateHistory,bt=G.wrap,Ct=c(j,t),xt=Y.createElement("span"),kt=g(Ct.UL).replace(/\\[-+*]/g,"[-+*]"),yt=g(Ct.OL).replace(/%d/g,"[0-9]+"),Tt=g(Ct.tabSize),Lt=g(Ct.PRE);V.event=function(e,t,n){return a(t,e,n)},V.modal=function(e,t,n){i(e)&&(n=t,t=e,e="default"),e=e||"default",n=n||{},et=Q.scrollTop||Q.parentNode.scrollTop,X.className=Ct.modalOverlayClass.replace(/%s/g,e),J.className=Ct.modalClass.replace(/%s/g,e),J.innerHTML='<div class="'+Ct.modalHeaderClass.replace(/%s/g,e)+'"></div><div class="'+Ct.modalContentClass.replace(/%s/g,e)+'"></div><div class="'+Ct.modalFooterClass.replace(/%s/g,e)+'"></div>';var r=J.style,l="left"in n,o="top"in n;r.visibility="hidden",Q.appendChild(X),Q.appendChild(J),W.setTimeout(function(){var e=J.offsetWidth,t=J.offsetHeight;r.position="absolute",r.left=l?n.left+"px":"50%",r.top=o?n.top+"px":"50%",r.zIndex="9999",r.marginLeft=(l?0:0-e/2)+"px",r.marginTop=(o?0:et-t/2)+"px",r.visibility="",J.offsetLeft<0&&!l&&(r.left=0,r.marginLeft=0),J.offsetTop<0&&!o&&(r.top=0,r.marginTop=0);var i=J.children[0];a(i,"mousedown",function(){return nt=J,it=rt-nt.offsetLeft,ot=lt-nt.offsetTop,!1}),a(Q,"mousemove",null),a(Q,"mousemove",function(n){rt=n.pageX,lt=n.pageY+et;var i,a,c=l?0:e/2,u=o?0:t/2;if(null!==nt){var s=l?e:0,f=o?t:0;i=rt-it+c,a=lt-ot+u,c>i&&(i=c),u>a&&(a=u),i+c+s>at&&(i=at-c-s),a+u+f>ct&&(a=ct-u-f),r.left=i+"px",r.top=a-et+"px"}})},10),i(t)&&t(X,J)},V.drop=function(e,t,n){i(e)&&(n=t,t=e,e="default"),!n&&tt&&(n={left:tt.offsetLeft,top:tt.offsetTop+tt.offsetHeight}),e=e||"default",n=n||{},et=Q.scrollTop||Q.parentNode.scrollTop,Z.className=Ct.dropClass.replace(/%s/g,e);var r=Z.style,l="left"in n,o="top"in n;r.visibility="hidden",Q.appendChild(Z),W.setTimeout(function(){var e=Z.offsetWidth,t=Z.offsetHeight;r.position="absolute",r.left=l?n.left+"px":"50%",r.top=o?n.top+"px":"50%",r.zIndex="9999",r.marginLeft=(l?0:0-e/2)+"px",r.marginTop=(o?0:et-t/2)+"px",r.visibility="",n.left+e>at&&(r.left=at-e+"px",r.marginLeft=0),n.top+t>ct&&(r.top=ct-t+"px",r.marginTop=0)},10),i(t)&&t(Z)},V.prompt=function(e,t,n,r,l){V.modal("prompt",function(l,o){var c=function(e){i(r)?(V.close(),r(e)):V.close(!0)},u=Y.createElement("input");u.type="text",u.value=t,a(u,"keydown",function(e){var r=e.keyCode;if(27==r)return V.close(!0),!1;if(n){if(13==r&&""!==this.value&&this.value!==t)return c(this.value),!1}else if(13==r)return c(this.value==t?"":this.value),!1});var s=Y.createElement("button");s.innerHTML=Ct.buttons.ok,a(s,"click",function(){return n?""!==u.value&&u.value!==t&&c(u.value):c(u.value==t?"":u.value),!1});var f=Y.createElement("button");f.innerHTML=Ct.buttons.cancel,a(f,"click",function(){return V.close(!0),!1}),a(s,"keydown",function(e){var t=e.keyCode;return 27==t?(V.close(!0),!1):39==t?(f.focus(),!1):void 0}),a(f,"keydown",function(e){var t=e.keyCode;return 27==t?(V.close(!0),!1):37==t?(s.focus(),!1):void 0}),o.children[0].innerHTML=e?e:"",o.children[1].appendChild(u),o.children[2].appendChild(s),o.children[2].appendChild(Y.createTextNode(" ")),o.children[2].appendChild(f),W.setTimeout(function(){u.select()},10)},l)},V.alert=function(e,t,n,r){V.modal("alert",function(r,l){var o=Y.createElement("button");o.innerHTML=Ct.buttons.ok,a(o,"click",function(){return i(n)?(V.close(),n()):V.close(!0),!1}),a(o,"keydown",function(e){return 27==e.keyCode?(V.close(!0),!1):void 0}),l.children[0].innerHTML=e?e:"",l.children[1].innerHTML=t?t:"",l.children[2].appendChild(o),W.setTimeout(function(){o.focus()},10)},r)},V.confirm=function(e,t,r,l){V.modal("confirm",function(l,o){var c=Y.createElement("button");c.innerHTML=Ct.buttons.ok,a(c,"click",function(){return n(r)&&i(r.OK)?(V.close(),r.OK()):V.close(!0),!1});var u=Y.createElement("button");u.innerHTML=Ct.buttons.cancel,a(u,"click",function(){return n(r)&&i(r.CANCEL)?(V.close(),r.CANCEL()):V.close(!0),!1}),a(c,"keydown",function(e){var t=e.keyCode;return 27==t?(V.close(!0),!1):39==t?(u.focus(),!1):void 0}),a(u,"keydown",function(e){var t=e.keyCode;return 27==t?(V.close(!0),!1):37==t?(c.focus(),!1):void 0}),o.children[0].innerHTML=e?e:"",o.children[1].innerHTML=t?t:"",o.children[2].appendChild(c),o.children[2].appendChild(Y.createTextNode(" ")),o.children[2].appendChild(u),W.setTimeout(function(){u.focus()},10)},l)},V.close=function(e){if(tt=null,nt=null,h(X)&&Q.removeChild(X),h(J)&&Q.removeChild(J),h(Z)&&Q.removeChild(Z),e&&e!==!1){var t=mt();o(e)||(e={}),ht("start"in e?e.start:t.start,"end"in e?e.end:t.end)}},a(W,"resize",function(){at=Q.parentNode.offsetWidth,ct=Q.parentNode.offsetHeight}),a(Q,"mouseup",function(){nt=null}),a(X,"click",function(){V.close(!0)}),V.scroll=function(e,t){l(e)?st.scrollTop=e:st.scrollTop+=parseInt(u(st,"line-height"),10),i(t)&&t()},V.time=function(e){var t=new Date,r=t.getFullYear(),l=t.getMonth()+1,i=t.getDate(),o=t.getHours(),a=t.getMinutes(),c=t.getSeconds(),u=t.getMilliseconds();10>l&&(l="0"+l),10>i&&(i="0"+i),10>o&&(o="0"+o),10>a&&(a="0"+a),10>c&&(c="0"+c),10>u&&(u="0"+u);var s={Y:""+r,m:""+l,d:""+i,H:""+o,i:""+a,s:""+c,u:""+u};return n(e)?s[e]:s},Ct.toolbar&&(xt.className=Ct.toolbarClass,st.parentNode.insertBefore(xt,"before"==Ct.toolbarPosition?st:null));var _t=Y.createElement("a");_t.href="#esc:"+(new Date).getTime(),_t.style.width=0,_t.style.height=0,st.parentNode.appendChild(_t),V.button=function(e,t){if("|"===e)return V.separator(t);if(t=t||{},t.title!==!1){var n,c=Y.createElement("a");if(c.className=Ct.toolbarButtonClass.replace(/%s/g,e),c.setAttribute("tabindex",-1),c.href="#"+e.replace(" ",":").replace(/[^a-z0-9\:]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,""),c.innerHTML=t.text?t.text.replace(/%s/g,e):'<i class="'+Ct.toolbarIconClass.replace(/%s/g,e)+'"></i>',t.title&&(c.title=t.title),o(t.attr))for(var u in t.attr)if(r(t.attr[u])&&"+="==t.attr[u].slice(0,2)){var s=c.getAttribute(u)||"";c.setAttribute(u,s+t.attr[u].slice(2))}else c.setAttribute(u,t.attr[u]);a(c,"click",function(e){if(i(t.click)){var n=this.hash.replace("#","");return V.close(),tt=c,t.click(e,V),Ct.click(e,V,n),Ct.update(e,V,n),!1}}),a(c,"keydown",function(e){return 27==e.keyCode?(V.close(!0),!1):void 0}),l(t.position)?(n=t.position<0?t.position+xt.children.length+1:t.position-1,xt.insertBefore(c,xt.children[n]||null)):xt.appendChild(c),j.buttons[e]=t}},V.separator=function(e){e=e||{};var t,n=Y.createElement("span");if(n.className=Ct.toolbarSeparatorClass,o(e.attr))for(var i in e.attr)if(r(e.attr[i])&&"+="==e.attr[i].slice(0,2)){var a=n.getAttribute(i)||"";n.setAttribute(i,a+e.attr[i].slice(2))}else n.setAttribute(i,e.attr[i]);l(e.position)?(t=e.position<0?e.position+xt.children.length+1:e.position-1,xt.insertBefore(n,xt.children[t]||null)):xt.appendChild(n)},G.toggle=function(e,t,n,r){var l=mt();if(l.before.slice(-e.length)!=e&&l.after.slice(0,t.length)!=t)bt(e,t,0===l.value.length&&r?function(){gt(/^.*$/,r===!0?Ct.placeholders.text:r)}:1);else{var o=l.before.slice(-e.length)==e?l.before.slice(0,-e.length):l.before,a=l.after.slice(0,t.length)==t?l.after.slice(t.length):l.after;st.value=o+l.value+a,ht(o.length,o.length+l.value.length,vt)}i(n)&&n()};var Ot=G.toggle,Et=0,$t=Ct.buttons;if(o($t)){var Ht={bold:{title:$t.bold,click:function(){var e=Ct.STRONG;Ot(e,e,1,!0)}},italic:{title:$t.italic,click:function(){var e=Ct.EM;Ot(e,e,1,!0)}},code:{title:$t.code,click:function(){var e=mt().value,t=Ct.CODE,n=Ct.PRE;if(-1!==e.indexOf("\n")&&e.length>0)if(-1===n.indexOf("%s")){var r="("+Lt+"|\\t| {4})";G[e.match(RegExp("^"+r))?"outdent":"indent"](n)}else{var l=n.split("%s");Ot(l[0],l[1]||l[0])}else Ot(t,t,1,!0)}},"quote-right":{title:$t.quote,click:function(){var e,t=mt(),n=p(t.before),r=f(t.value),l=d(t.after),i=n.length>0?"\n\n":"",o=Ct.placeholders.text;r==o?ht(t.start,t.end):r.length>0?G[">"==r[0]?"outdent":"indent"]("> "):(st.value=n+i+"> "+o+"\n\n"+l,e=n.length+i.length+2,ht(e,e+o.length,vt))}},header:{title:$t.heading,click:function(){var e,t=mt(),n=["","=","-","### ","#### ","##### ","###### "],r=p(t.before.replace(/#+ $/,"")),l=f(t.value.replace(/#+ |\n+[-=]+/,"").replace(/\n+/g," ")),i=d(t.after.replace(/^\n+[-=]+/,"")),o=r.length>0?"\n\n":"";if(Et=Et<n.length-1?Et+1:0,t.value.length>0)Et>0&&3>Et?(st.value=r+o+l+"\n"+l.replace(/./g,n[Et])+"\n\n"+i,e=r.length+o.length,ht(e,e+l.length,vt)):(st.value=r+o+n[Et]+l+"\n\n"+i,e=r.length+o.length+n[Et].length,ht(e,e+l.length,vt));else{var a=Ct.placeholders.heading_text;Et=1,st.value=r+o+a+"\n"+a.replace(/./g,n[Et])+"\n\n"+i,e=r.length+o.length,ht(e,e+a.length,vt)}}},link:{title:$t.link,click:function(e){var t,n,r=mt(),l=Ct.placeholders.link_text;V.prompt(Ct.prompts.link_url_title,Ct.prompts.link_url,!0,function(i){n=i,V.prompt(Ct.prompts.link_title_title,Ct.prompts.link_title,!1,function(i){t=i,bt("[","]("+n+(""!==t?' "'+t+'"':"")+")",0===r.value.length?function(){gt(/^/,l)}:1),Ct.update(e,V)})})}},image:{title:$t.image,click:function(e){V.prompt(Ct.prompts.image_url_title,Ct.prompts.image_url,!0,function(t){var n=mt(),r=p(n.before),l=d(n.after),i=r.length>0?"\n\n":"",o=decodeURIComponent(t.substring(t.lastIndexOf("/")+1,t.lastIndexOf(".")).replace(/[-+._]+/g," ")).toLowerCase().replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()});o=-1===o.indexOf("/")&&-1!==t.indexOf(".")?o:Ct.placeholders.image_alt,st.value=r+i+"!["+o+"]("+t+")\n\n"+l,ht(r.length+i.length+2+o.length+2+t.length+3,function(){Ct.update(e,V),vt()})})}},"list-ol":{title:$t.ol,click:function(){var e=mt(),t=Ct.placeholders.list_ol_text,n=0;if(e.value==t)ht(e.start,e.end);else if(e.value.length>0)ft("",function(){gt(/^[^\n]/gm,function(e){return n++,e.replace(/^/," "+Ct.OL.replace(/%d/g,n))})});else{var r=" "+Ct.OL.replace(/%d/g,1);t=r+t,dt(t,function(){ht(e.start+r.length,e.start+t.length,vt)})}}},"list-ul":{title:$t.ul,click:function(){var e=mt(),t=Ct.placeholders.list_ul_text;if(e.value==t)ht(e.start,e.end);else{var n=" "+Ct.UL;e.value.length>0?ft(n):(t=n+t,dt(t,function(){ht(e.start+n.length,e.start+t.length,vt)}))}}},"ellipsis-h":{title:$t.rule,click:function(){var e=mt(),t=p(e.before),n=d(e.after),r=t.length>0?"\n\n":"";st.value=t+r+Ct.HR+"\n\n"+n,ht(t.length+r.length+Ct.HR.length+2,vt)}},undo:{title:$t.undo,click:G.undo},repeat:{title:$t.redo,click:G.redo}};for(var wt in Ht)V.button(wt,Ht[wt])}a(st,"focus",V.close),a(st,"copy",function(e){var t=mt();W.setTimeout(function(){Ct.copy(t),Ct.update(e,V)},1)}),a(st,"cut",function(e){var t=mt();W.setTimeout(function(){t.end=t.start,Ct.cut(t),Ct.update(e,V),vt()},1)}),a(st,"paste",function(e){var t=mt();W.setTimeout(function(){t.end=mt().end,t.value=st.value.substring(t.start,t.end),Ct.paste(t),Ct.update(e,V),vt()},1)}),a(st,"keydown",function(e){var t=mt(),n=t.before,r=t.value,l=t.after,i=t.start,o=t.end,a=e.keyCode,c=e.ctrlKey,u=e.shiftKey,f=e.altKey,d=9==a;W.setTimeout(function(){Ct.keydown(e,V),Ct.update(e,V)},1);var h=n,Y=l[0],j="\\"==h.slice(-1);if(-1!==h.indexOf("(")&&u&&48==a&&")"==Y&&!j||-1!==h.indexOf("{")&&u&&221==a&&"}"==Y&&!j||-1!==h.indexOf("[")&&221==a&&"]"==Y&&!j||-1!==h.indexOf('"')&&u&&222==a&&'"'==Y&&!j||-1!==h.indexOf("'")&&!u&&222==a&&"'"==Y&&!j||-1!==h.indexOf("`")&&!u&&192==a&&"`"==Y&&!j||-1!==h.indexOf("<")&&u&&190==a&&">"==Y&&!j)return ht(o+1),!1;if(u&&57==a&&!j)return s("("+r+")",t);if(u&&219==a&&!j)return s("{"+r+"}",t);if(!u&&219==a&&!j)return s("["+r+"]",t);if(u&&222==a&&!j)return s('"'+r+'"',t);if(!u&&222==a&&!j)return s("'"+r+"'",t);if(!u&&192==a&&!j)return s("`"+r+"`",t);if(u&&188==a&&!j)return s("<"+r+">",t);if(u&&d)return pt("( *"+yt+"| *"+kt+"|> *|"+Tt+")",1,!0),!1;if(d){if(n.match(/<[^\/>]*?$/)&&">"==l[0]){var Q=/<([^\/>]*?)$/.exec(n);return st.value=n+" "+r+"></"+Q[1].split(" ")[0]+l,ht(i+1,vt),!1}return ft(Ct.tabSize),!1}if(c&&90==a)return G.undo(),!1;if(c&&89==a||c&&82==a)return G.redo(),!1;if(Ct.shortcut){if(c&&66==a)return Ht.bold.click(),!1;if(c&&73==a)return Ht.italic.click(),!1;if(c&&81==a)return Ht["quote-right"].click(),!1;if(c&&72==a)return Ht.header.click(),!1;if(c&&76==a)return Ht.link.click(),!1;if(c&&71==a)return Ht.image.click(),!1}if(32==a){var Q="(^|\\n)("+p(yt)+"|"+p(kt)+")";if(n.match(RegExp(Q+"$")))return st.value=n.replace(RegExp(Q+"$"),"$1 $2 ")+r+l,ht(o+2,vt),!1}if(13==a){if(f&&0===r.length)return dt(F),!1;var X=RegExp("(?:^|\\n)( *)("+yt+"|"+kt+"|> )( *)(.*?)$");if(n.match(X)){var J=X.exec(n),Z=RegExp(yt).test(J[2])?Ct.OL.replace(/%d/g,parseInt(J[2],10)+1):J[2];return dt("\n"+J[1]+Z+J[3],1),V.scroll(),!1}var et=RegExp("(?:^|\\n)(("+Tt+")+)(.*?)$").exec(n),tt=et?et[1]:"";return n.match(/[\(\{\[]$/)&&l.match(/^[\]\}\)]/)||n.match(/<[^\/]*?>$/)&&l.match(/^<\//)?(dt("\n"+tt+Tt+"\n"+tt,function(){ht(i+tt.length+Ct.tabSize.length+1,vt)}),V.scroll(),!1):(dt("\n"+tt),V.scroll(),!1)}var nt={"'":v,'"':C,"---":k,"--":x,"...":y,"|":T,"(c)":L,"(C)":L,"(p)":_,"(P)":_,"(sm)":O,"(SM)":O," sm":O," SM":O,"(tm)":E,"(TM)":E," tm":E," TM":E,"(r)":$,"(R)":$,"+-":H,"-+":H,x:w,"/":N,"^":R,"<<":S,">>":A,"<":M,">":I,"<=":B,">=":P,"!=":z};if(r.length>0){if(f){gt(/'([^']*?)'/g,m+"$1"+v,ut),gt(/"([^"]*?)"/g,b+"$1"+C,ut);for(var rt in nt)gt(RegExp(g(rt),"g"),nt[rt],ut);return vt(),!1}}else{if(f){if(-1!==n.indexOf('"')&&'"'==l[0])return st.value=n.replace(/"([^"]*?)$/,b+"$1")+C+l.slice(1),ht(o,vt),!1;if(-1!==n.indexOf("'")&&"'"==l[0])return st.value=n.replace(/'([^']*?)$/,m+"$1")+v+l.slice(1),ht(o,vt),!1;if(n.slice(-2).match(/\w'$/i))return st.value=n.slice(0,-1)+v+l,ht(o,vt),!1;if(n.match(/\((c|p|sm|tm|r)$/i)&&")"==l[0]){var lt=n.match(/\((sm|tm)$/i)?2:1;return st.value=n.slice(0,-(lt+1))+nt["("+n.slice(-lt).toLowerCase()+")"]+l.slice(1),ht(o-lt,vt),!1}var it=n.replace(/&lt;/g,"<").replace(/&gt;/g,">"),ot=l.replace(/&lt;/g,"<").replace(/&gt;/g,">");if(-1!==it.indexOf("<<")&&0===ot.indexOf(">>"))return st.value=n.replace(/(?:<<|&lt;&lt;)([^<]*)$/,S+"$1")+l.replace(/^(?:>>|&gt;&gt;)/,A),ht(it.length-1,vt),!1;if(-1!==it.indexOf("<")&&0===ot.indexOf(">"))return st.value=n.replace(/(?:<|&lt;)([^<]*)$/,M+"$1")+l.replace(/^(?:>|&gt;)/,I),ht(it.length,vt),!1;for(var rt in nt)if(n.slice(-rt.length)==rt)return st.value=n.slice(0,-rt.length)+nt[rt]+l,ht(i-rt.length+1,vt),!1;if(37==a)return dt(U),!1;if(38==a)return dt(K),!1;if(39==a)return dt(D),!1;if(40==a)return dt(q),!1}if(8==a){var Q=" *("+yt+"|"+kt+"|> )";if(n.match(RegExp(Q+"$")))return pt(Q,1,!0),!1;if(n.match(RegExp(Tt+"$")))return pt(Ct.tabSize),!1;if(n.match(/<\/?[^>]*?>$/))return pt("</?[^>]*?>",1,!0),!1;switch(n.slice(-1)){case"(":return Ot("(",")"),!1;case"{":return Ot("{","}"),!1;case"[":return Ot("[","]"),!1;case'"':return Ot('"','"'),!1;case"'":return Ot("'","'"),!1;case"<":return Ot("<",">"),!1;case"*":return Ot("*","*"),!1;case"_":return Ot("_","_"),!1;case"~":return Ot("~","~"),!1;case"`":return Ot("`","`"),!1;case b:return Ot(b,C),!1;case m:return Ot(m,v),!1;case S:return Ot(S,A),!1;case M:return Ot(M,I),!1}}}return 39==a&&l.match(/^<\/.*?>/)?(ht(o+l.indexOf(">")+1),!1):27==a?(_t.focus(),!1):void(f||c||u||W.setTimeout(vt,1))});var Nt=RegExp("(^| )"+Ct.areaClass+"( |$)"),Rt=st.className;Rt.match(Nt)||(st.className=f(Rt+" "+Ct.areaClass)),Ct.ready(V),V.grip=G,V.grip.config=Ct};